<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results</title>
    <!--~~~~~~~~~~~~~~~ Remix Icon ~~~~~~~~~~~~~~~-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.2.0/remixicon.min.css" />

    <!--~~~~~~~~~~~~~~~ Swiper's CSS ~~~~~~~~~~~~~~~-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
        integrity="sha256-kLaT2gvDlChQGsWxBjqE0i+lsIzwzE/yoC9z8hVS+CGU/" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
        integrity="sha256-WBkoLaoqshP9dd+LRCBirV84ZyCmtEFgCwoS3G4jGyG/" crossorigin=""></script>
    <!--~~~~~~~~~~~~~~~ Local CSS ~~~~~~~~~~~~~~~-->
    <link rel="stylesheet" href="{{url_for('static',filename='dist/css/output.css')}}">
</head>

<body>
    <!--~~~~~~~~~~~~~~~ Header ~~~~~~~~~~~~~~~-->
    <header id="navbar" class="bg-green-950 fixed w-full top-0 left-0 z-50">

        <nav class="container flex items-center justify-between h-16 sm:h-20">

            <div class="font-Lobster sm:text-2xl">Goba's ML System</div>

            <div id="nav-menu" class="absolute top-0 left-[-100%] min-h-[80vh] w-full
                bg-green-950/80 backdrop-blur-sm flex items-center
                justify-center duration-300 overflow-hidden lg:static 
                lg:min-h-fit lg:bg-transparent lg:w-auto">

                <ul class="flex flex-col items-center gap-8 lg:flex-row">
                    <li>
                        <a href="/past_recommendations" class="nav-link active">Show past recommendations</a>
                    </li>
                    <li>
                        <form action="home" method="post">
                            <!-- go back to main sitr -->
                            <button data-modal-target="authentication-modal" data-modal-toggle="authentication-modal"
                                class="btn btn_outline">
                                <span class="flex gap-2">Go back
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
                                        class="size-6">
                                        <path fill-rule="evenodd"
                                            d="M16.5 3.75a1.5 1.5 0 0 1 1.5 1.5v13.5a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5V15a.75.75 0 0 0-1.5 0v3.75a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V5.25a3 3 0 0 0-3-3h-6a3 3 0 0 0-3 3V9A.75.75 0 1 0 9 9V5.25a1.5 1.5 0 0 1 1.5-1.5h6Zm-5.03 4.72a.75.75 0 0 0 0 1.06l1.72 1.72H2.25a.75.75 0 0 0 0 1.5h10.94l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 0 0-1.06 0Z"
                                            clip-rule="evenodd" />
                                    </svg>
                                </span>
                            </button>
                        </form>
                    </li>
                </ul>
            </div>


            <div class="absolute bottom-0 -right-10 opacity-90 lg:hidden">
                <img src="{{url_for('static', filename='img/leaf-1.png')}}" alt="" class="w-32" />
            </div>

            <div class="absolute -top-5 -left-0 rotate-90 opacity-50 lg:hidden">
                <img src="{{url_for('static', filename='img/leaf-2.png')}}" alt="" class="w-32" />
            </div>
            </div>

            <div id="hamburger" class="text-xl sm:text-3xl cursor-pointer z-50 lg:hidden">
                <!-- <i class="ri-menu-4-line" id="humburger"></i> -->
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                    <path fill-rule="evenodd"
                        d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z"
                        clip-rule="evenodd" />
                </svg>
            </div>

        </nav>
    </header>

    <div class=" mt-24 max-w-sm mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl">
        <div class="md:flex">
            <div class="md:flex-shrink-0">
                <img class="h-48 w-full object-cover md:w-48" src="{{url_for('static', filename='img/results.jpg')}}"
                    alt="A placeholder image">
            </div>
            <div class="p-8">
                {% if prediction_text == "NR II ,NR III, NR I" %}
                <div class="uppercase tracking-wide text-sm text-indigo-500 font-semibold">Region A Result</div>
                <a href="#" class="block mt-1 text-lg leading-tight font-medium text-black hover:underline">Region A
                    Description</a>
                {% elif prediction_text == "NR IV, NR V" %}
                <div class="uppercase tracking-wide text-sm text-indigo-500 font-semibold">Region B Result</div>
                <a href="#" class="block mt-1 text-lg leading-tight font-medium text-black hover:underline">Region B
                    Description</a>
                {% else %}
                <div class="uppercase tracking-wide text-sm text-indigo-500 font-semibold">Unknown Region Result</div>
                <a href="#" class="block mt-1 text-lg leading-tight font-medium text-black hover:underline">Unknown
                    Region Description</a>
                {% endif %}
                <p class="mt-2 text-gray-500">{{prediction_text}}</p>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="mt-10 max-w-sm mx-auto text-black p-10 bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl">
            <form method="POST" action="/optimize_land">
                <label for="crop-livestock" class="block text-sm font-medium text-gray-700">
                    With this land allocated for you what do you need to do?:
                </label>
                <select id="crop-livestock" name="crop-livestock" class="mt-1 block w-full">
                    {% for key, value in crops.items() %}
                    <option value="{{ key }}">{{ value }}</option>
                    {% endfor %}
                </select>

                <div class="col-span-2 sm:col-span-1 mt-10">
                    <label for="total_hectares"
                        class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Total hectares
                        required</label>
                    <input type="number" name="total-hectares" id="total-hectares"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                        placeholder="40" required="">
                </div>
                <div class="col-span-2 sm:col-span-1 mt-10">
                    <label for="farmable_hectares"
                        class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Farmable Hectares</label>
                    <input type="number" name="farmable-hectares" id="farmable-hectares"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                        placeholder="10" required="">
                </div>

                <button type="submit"
                    class="mt-4 bg-indigo-600 hover:bg-indigo-700 focus:ring-indigo-200 focus:ring-offset-2 focus:ring-offset-white text-white font-medium rounded-md px-5 py-2.5 text-center">
                    Optimize Land
                </button>

            </form>
        </div>

        <div class="container mx-auto p-6 mt-24 border-gray-950">
            <h1 class="text-3xl font-bold mb-4">Optimized Land Use Recommendations</h1>
            <p>You have a total of {{ total_hectares }} hectares and can farm {{ farmable_hectares }} hectares.</p>
            <p class="text-lg mb-6">Based on your selection of "<span
                    class="font-semibold">{{ crop_livestock }}</span>", here are some optimized land use
                recommendations:</p>
            <ul class="list-disc list-inside space-y-2 text-black">
                {% for crop, hectares in recommendations.items() %}
                <li class="bg-white shadow-md p-3 rounded-md">{{ crop }}: {{ hectares }} hectares</li>
                {% endfor %}
            </ul>
            {% if plot_div %}
                <h2 class="mt-5">Crop Distribution Pie Chart:</h2>
                <div>{{ plot_div | safe }}</div>
            {% endif %}
        </div>

        <div id="map" class="h-96"></div>

    </div>

    <!--~~~~~~~~~~~~~~~ Scroll Up ~~~~~~~~~~~~~~~-->
    <a href="#" class=" fixed right-4 -bottom-1/2 bg-yellow-500 shadow-sm inline-block px-3 py-1
    md:px-4 md:py-2 rounded-md text-lg z-50 hover:-translate-y-1 duration-300" id="scroll-up">
        <i class="ri-arrow-up-line"></i>
    </a>

    <script>
        var map = L.map('map').setView([-20.20, 30.00], 10); // Adjust coordinates and zoom as needed

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Sample land use zones (replace with your actual data)
        var landUseZones = [
            {
                "type": "Feature",
                "geometry": {
                    "type": "Polygon",
                    "coordinates": [
                        [
                            [30.0, -20.0],
                            [31.0, -20.0],
                            [31.0, -21.0],
                            [30.0, -21.0],
                            [30.0, -20.0]
                        ]
                    ]
                },
                "properties": {
                    "name": "Crop Zone 1",
                    "recommendations": ["Recommendation 1", "Recommendation 2"]
                }
            }
        ];

        // Add land use zones to the map
        L.geoJSON(landUseZones, {
            style: function (feature) {
                return {
                    color: 'border-blue-500',
                    fillColor: 'bg-blue-200',
                    fillOpacity: 0.5
                };
            },
            onEachFeature: function (feature, layer) {
                layer.bindPopup(`
                    <div class="bg-white p-4 rounded shadow">
                        <h3 class="text-lg font-bold">${feature.properties.name}</h3>
                        <ul>
                            ${feature.properties.recommendations.map(rec => `<li>${rec}</li>`).join('')}
                        </ul>
                    </div>
                `);
            }
        }).addTo(map);
    </script>

    <!--~~~~~~~~~~~~~~~ Swiper JS ~~~~~~~~~~~~~~~-->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!--~~~~~~~~~~ SCROLLREVEAL ~~~~~~~~~~-->
    <script src="{{ url_for('static', filename='/js/scrollreveal.min.js') }}"></script>

    <!--~~~~~~~~~~ mainjs ~~~~~~~~~~-->
    <script src="{{ url_for('static', filename='/js/main.js') }}"></script>

    <!--~~~~~~~~~~ flowbiteminjs ~~~~~~~~~~-->
    <script src="{{ url_for('static', filename='/js/flowbite.min.js') }}"></script>

</body>

</html>